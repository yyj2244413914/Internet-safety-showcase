<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SecureDataFlow Dashboard</title>
  <!-- 引入外部资源 -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
  
  <!-- Tailwind 配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#165DFF',
            secondary: '#36CFC9',
            success: '#52C41A',
            warning: '#FAAD14',
            danger: '#FF4D4F',
            info: '#1890FF',
            dark: '#1D2129',
            'dark-2': '#4E5969',
            'light-1': '#F2F3F5',
            'light-2': '#E5E6EB',
            'light-3': '#C9CDD4'
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .card-shadow {
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      }
      .card-hover {
        transition: all 0.3s ease;
      }
      .card-hover:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
      }
      .gradient-bg {
        background: linear-gradient(135deg, #165DFF 0%, #0E42D2 100%);
      }
      .pulse-animation {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }
      @keyframes pulse {
        0%, 100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }
      .progress-bar {
        position: relative;
        overflow: hidden;
      }
      .progress-bar::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        background: rgba(255, 255, 255, 0.2);
        transform: translateX(-100%);
        animation: progress 1.5s infinite;
      }
      @keyframes progress {
        100% {
          transform: translateX(100%);
        }
      }
    }
  </style>
</head>

<body class="font-inter bg-gray-50 text-dark min-h-screen flex flex-col">
  <!-- 顶部导航栏 -->
  <header class="bg-white shadow-sm fixed w-full z-50 transition-all duration-300" id="header">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <!-- 左侧Logo和标题 -->
        <div class="flex items-center">
          <div class="flex-shrink-0 flex items-center">
            <div class="w-8 h-8 rounded-md gradient-bg flex items-center justify-center">
              <i class="fa fa-shield text-white"></i>
            </div>
            <span class="ml-2 text-lg font-semibold text-dark">SecureDataFlow Dashboard</span>
          </div>
        </div>
        
        <!-- 右侧工具栏 -->
        <div class="flex items-center space-x-4">
          <!-- 通知图标 -->
          <div class="relative">
            <button class="p-2 rounded-full hover:bg-light-1 transition-colors relative">
              <i class="fa fa-bell-o text-dark-2"></i>
              <span class="absolute top-1 right-1 w-2 h-2 bg-danger rounded-full"></span>
            </button>
          </div>
          
          <!-- 刷新按钮 -->
          <button class="p-2 rounded-full hover:bg-light-1 transition-colors" id="refreshBtn">
            <i class="fa fa-refresh text-dark-2"></i>
          </button>
          
          <!-- 用户信息 -->
          <div class="flex items-center">
            <img class="h-8 w-8 rounded-full object-cover" src="https://picsum.photos/id/1005/200/200" alt="用户头像">
            <span class="ml-2 text-sm font-medium hidden md:block">管理员</span>
            <i class="fa fa-angle-down ml-1 text-dark-2 text-xs hidden md:block"></i>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- 主内容区 -->
  <main class="flex-1 pt-20 pb-10">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <!-- 页面标题 -->
      <div class="mb-8">
        <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-dark">Dashboard概览</h1>
        <p class="text-dark-2 mt-1">实时监控系统状态、任务进度和安全告警</p>
      </div>
      
      <!-- 状态指示器 -->
      <div class="flex items-center mb-6">
        <div class="flex items-center mr-6">
          <span class="w-3 h-3 bg-success rounded-full pulse-animation"></span>
          <span class="ml-2 text-sm text-dark-2">系统正常运行中</span>
        </div>
        <div class="flex items-center">
          <span class="text-sm text-dark-2">上次更新: <span id="lastUpdate">刚刚</span></span>
        </div>
      </div>
      
      <!-- 概览统计卡片 -->
      <section class="mb-8">
        <h2 class="text-lg font-semibold mb-4 text-dark">系统概览</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
          <!-- 任务总数卡片 -->
          <div class="bg-white rounded-xl p-6 card-shadow card-hover">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-dark-2 text-sm mb-1">任务总数</p>
                <h3 class="text-3xl font-bold text-dark mb-2" id="totalTasks">1,284</h3>
                <p class="text-success text-sm flex items-center">
                  <i class="fa fa-arrow-up mr-1"></i> 12% <span class="text-dark-2 ml-1">较昨日</span>
                </p>
              </div>
              <div class="w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center">
                <i class="fa fa-tasks text-primary text-xl"></i>
              </div>
            </div>
            <div class="mt-4 h-10">
              <canvas id="tasksChart"></canvas>
            </div>
          </div>
          
          <!-- 活跃节点数卡片 -->
          <div class="bg-white rounded-xl p-6 card-shadow card-hover">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-dark-2 text-sm mb-1">活跃节点数</p>
                <h3 class="text-3xl font-bold text-dark mb-2" id="activeNodes">36</h3>
                <p class="text-success text-sm flex items-center">
                  <i class="fa fa-arrow-up mr-1"></i> 3 <span class="text-dark-2 ml-1">较昨日</span>
                </p>
              </div>
              <div class="w-12 h-12 rounded-lg bg-secondary/10 flex items-center justify-center">
                <i class="fa fa-server text-secondary text-xl"></i>
              </div>
            </div>
            <div class="mt-4 h-10">
              <canvas id="nodesChart"></canvas>
            </div>
          </div>
          
          <!-- 数据流量卡片 -->
          <div class="bg-white rounded-xl p-6 card-shadow card-hover">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-dark-2 text-sm mb-1">数据流量</p>
                <h3 class="text-3xl font-bold text-dark mb-2" id="dataTraffic">846 GB</h3>
                <p class="text-danger text-sm flex items-center">
                  <i class="fa fa-arrow-down mr-1"></i> 5% <span class="text-dark-2 ml-1">较昨日</span>
                </p>
              </div>
              <div class="w-12 h-12 rounded-lg bg-info/10 flex items-center justify-center">
                <i class="fa fa-exchange text-info text-xl"></i>
              </div>
            </div>
            <div class="mt-4 h-10">
              <canvas id="trafficChart"></canvas>
            </div>
          </div>
          
          <!-- 平均延迟卡片 -->
          <div class="bg-white rounded-xl p-6 card-shadow card-hover">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-dark-2 text-sm mb-1">平均延迟</p>
                <h3 class="text-3xl font-bold text-dark mb-2" id="avgLatency">246 ms</h3>
                <p class="text-success text-sm flex items-center">
                  <i class="fa fa-arrow-down mr-1"></i> 18 ms <span class="text-dark-2 ml-1">较昨日</span>
                </p>
              </div>
              <div class="w-12 h-12 rounded-lg bg-warning/10 flex items-center justify-center">
                <i class="fa fa-clock-o text-warning text-xl"></i>
              </div>
            </div>
            <div class="mt-4 h-10">
              <canvas id="latencyChart"></canvas>
            </div>
          </div>
        </div>
      </section>
      
      <!-- 图表和最近任务区域 -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
        <!-- 系统状态图表 -->
        <div class="lg:col-span-2 bg-white rounded-xl p-6 card-shadow">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-lg font-semibold text-dark">系统性能趋势</h2>
            <div class="flex space-x-2">
              <button class="px-3 py-1 text-xs rounded-md bg-primary/10 text-primary">今日</button>
              <button class="px-3 py-1 text-xs rounded-md hover:bg-light-1 text-dark-2">本周</button>
              <button class="px-3 py-1 text-xs rounded-md hover:bg-light-1 text-dark-2">本月</button>
            </div>
          </div>
          <div class="h-80">
            <canvas id="systemTrendChart"></canvas>
          </div>
        </div>
        
        <!-- 最近任务列表 -->
        <div class="bg-white rounded-xl p-6 card-shadow">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-lg font-semibold text-dark">最近任务</h2>
            <button class="text-primary text-sm hover:underline">查看全部</button>
          </div>
          
          <div class="space-y-5" id="recentTasks">
            <!-- 任务项1 -->
            <div class="border-b border-light-2 pb-4 last:border-0 last:pb-0">
              <div class="flex justify-between items-start mb-2">
                <h3 class="font-medium text-dark">数据加密传输</h3>
                <span class="px-2 py-0.5 text-xs rounded-full bg-success/10 text-success">已完成</span>
              </div>
              <div class="flex justify-between text-sm text-dark-2 mb-2">
                <span>发起人: 张三</span>
                <span>2小时前</span>
              </div>
              <div class="text-xs text-dark-2 mb-1">任务类型: 加密任务</div>
              <div class="w-full bg-light-1 rounded-full h-1.5">
                <div class="bg-success h-1.5 rounded-full" style="width: 100%"></div>
              </div>
            </div>
            
            <!-- 任务项2 -->
            <div class="border-b border-light-2 pb-4 last:border-0 last:pb-0">
              <div class="flex justify-between items-start mb-2">
                <h3 class="font-medium text-dark">节点健康检查</h3>
                <span class="px-2 py-0.5 text-xs rounded-full bg-warning/10 text-warning">进行中</span>
              </div>
              <div class="flex justify-between text-sm text-dark-2 mb-2">
                <span>发起人: 系统自动</span>
                <span>45分钟前</span>
              </div>
              <div class="text-xs text-dark-2 mb-1">任务类型: 系统任务</div>
              <div class="w-full bg-light-1 rounded-full h-1.5 progress-bar">
                <div class="bg-warning h-1.5 rounded-full" style="width: 68%"></div>
              </div>
            </div>
            
            <!-- 任务项3 -->
            <div class="border-b border-light-2 pb-4 last:border-0 last:pb-0">
              <div class="flex justify-between items-start mb-2">
                <h3 class="font-medium text-dark">漏洞扫描</h3>
                <span class="px-2 py-0.5 text-xs rounded-full bg-primary/10 text-primary">待处理</span>
              </div>
              <div class="flex justify-between text-sm text-dark-2 mb-2">
                <span>发起人: 李四</span>
                <span>1小时前</span>
              </div>
              <div class="text-xs text-dark-2 mb-1">任务类型: 安全任务</div>
              <div class="w-full bg-light-1 rounded-full h-1.5">
                <div class="bg-primary h-1.5 rounded-full" style="width: 0%"></div>
              </div>
            </div>
            
            <!-- 任务项4 -->
            <div class="border-b border-light-2 pb-4 last:border-0 last:pb-0">
              <div class="flex justify-between items-start mb-2">
                <h3 class="font-medium text-dark">日志分析</h3>
                <span class="px-2 py-0.5 text-xs rounded-full bg-danger/10 text-danger">失败</span>
              </div>
              <div class="flex justify-between text-sm text-dark-2 mb-2">
                <span>发起人: 王五</span>
                <span>3小时前</span>
              </div>
              <div class="text-xs text-dark-2 mb-1">任务类型: 分析任务</div>
              <div class="w-full bg-light-1 rounded-full h-1.5">
                <div class="bg-danger h-1.5 rounded-full" style="width: 45%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 安全告警信息区 -->
      <section>
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-lg font-semibold text-dark">安全告警信息</h2>
          <div class="flex items-center">
            <span class="text-sm text-dark-2 mr-2">共 <span class="text-danger font-medium">7</span> 条告警</span>
            <button class="text-primary text-sm hover:underline">清除全部</button>
          </div>
        </div>
        
        <div class="bg-white rounded-xl overflow-hidden card-shadow">
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-light-2">
              <thead class="bg-light-1">
                <tr>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-dark-2 uppercase tracking-wider">告警类型</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-dark-2 uppercase tracking-wider">详细信息</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-dark-2 uppercase tracking-wider">发生时间</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-dark-2 uppercase tracking-wider">状态</th>
                  <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-dark-2 uppercase tracking-wider">操作</th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-light-2">
                <!-- 告警项1 -->
                <tr class="hover:bg-light-1/50 transition-colors">
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-8 h-8 rounded-full bg-danger/10 flex items-center justify-center mr-3">
                        <i class="fa fa-exclamation-triangle text-danger"></i>
                      </div>
                      <div>
                        <div class="text-sm font-medium text-dark">TEE远程证明失败</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4">
                    <div class="text-sm text-dark-2">节点node-17的TEE远程证明验证失败</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-dark-2">10分钟前</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs rounded-full bg-danger/10 text-danger">未处理</span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <button class="text-primary hover:text-primary/80 mr-3">处理</button>
                    <button class="text-dark-2 hover:text-dark">忽略</button>
                  </td>
                </tr>
                
                <!-- 告警项2 -->
                <tr class="hover:bg-light-1/50 transition-colors">
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-8 h-8 rounded-full bg-warning/10 flex items-center justify-center mr-3">
                        <i class="fa fa-sign-out text-warning"></i>
                      </div>
                      <div>
                        <div class="text-sm font-medium text-dark">节点掉线</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4">
                    <div class="text-sm text-dark-2">节点node-08失去连接超过15分钟</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-dark-2">35分钟前</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs rounded-full bg-warning/10 text-warning">处理中</span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <button class="text-primary hover:text-primary/80 mr-3">查看</button>
                    <button class="text-dark-2 hover:text-dark">忽略</button>
                  </td>
                </tr>
                
                <!-- 告警项3 -->
                <tr class="hover:bg-light-1/50 transition-colors">
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-8 h-8 rounded-full bg-danger/10 flex items-center justify-center mr-3">
                        <i class="fa fa-shield text-danger"></i>
                      </div>
                      <div>
                        <div class="text-sm font-medium text-dark">攻击告警</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4">
                    <div class="text-sm text-dark-2">检测到来自IP: 192.168.1.105的异常访问模式</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-dark-2">1小时前</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs rounded-full bg-success/10 text-success">已解决</span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <button class="text-primary hover:text-primary/80 mr-3">详情</button>
                    <button class="text-dark-2 hover:text-dark">删除</button>
                  </td>
                </tr>
                
                <!-- 告警项4 -->
                <tr class="hover:bg-light-1/50 transition-colors">
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-8 h-8 rounded-full bg-danger/10 flex items-center justify-center mr-3">
                        <i class="fa fa-exclamation-triangle text-danger"></i>
                      </div>
                      <div>
                        <div class="text-sm font-medium text-dark">TEE远程证明失败</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4">
                    <div class="text-sm text-dark-2">节点node-03的TEE远程证明验证失败</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-dark-2">2小时前</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs rounded-full bg-success/10 text-success">已解决</span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <button class="text-primary hover:text-primary/80 mr-3">详情</button>
                    <button class="text-dark-2 hover:text-dark">删除</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <!-- 分页 -->
          <div class="px-6 py-4 bg-white border-t border-light-2 flex items-center justify-between">
            <div class="flex-1 flex justify-between sm:hidden">
              <button class="relative inline-flex items-center px-4 py-2 border border-light-2 text-sm font-medium rounded-md text-dark-2 bg-white hover:bg-light-1">
                上一页
              </button>
              <button class="ml-3 relative inline-flex items-center px-4 py-2 border border-light-2 text-sm font-medium rounded-md text-dark-2 bg-white hover:bg-light-1">
                下一页
              </button>
            </div>
            <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
              <div>
                <p class="text-sm text-dark-2">
                  显示第 <span class="font-medium">1</span> 至 <span class="font-medium">4</span> 条，共 <span class="font-medium">7</span> 条结果
                </p>
              </div>
              <div>
                <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
                  <button class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-light-2 bg-white text-sm font-medium text-dark-2 hover:bg-light-1">
                    <span class="sr-only">上一页</span>
                    <i class="fa fa-chevron-left text-xs"></i>
                  </button>
                  <button class="relative inline-flex items-center px-4 py-2 border border-light-2 bg-primary text-sm font-medium text-white">
                    1
                  </button>
                  <button class="relative inline-flex items-center px-4 py-2 border border-light-2 bg-white text-sm font-medium text-dark-2 hover:bg-light-1">
                    2
                  </button>
                  <button class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-light-2 bg-white text-sm font-medium text-dark-2 hover:bg-light-1">
                    <span class="sr-only">下一页</span>
                    <i class="fa fa-chevron-right text-xs"></i>
                  </button>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- 页脚 -->
  <footer class="bg-white border-t border-light-2 py-6">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="text-dark-2 text-sm mb-4 md:mb-0">
          © 2023 安全监控平台. 保留所有权利.
        </div>
        <div class="flex space-x-6">
          <a href="#" class="text-dark-2 hover:text-primary text-sm">使用文档</a>
          <a href="#" class="text-dark-2 hover:text-primary text-sm">隐私政策</a>
          <a href="#" class="text-dark-2 hover:text-primary text-sm">联系我们</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', function() {
      // 初始化图表
      initCharts();
      
      // 绑定刷新按钮事件
      document.getElementById('refreshBtn').addEventListener('click', function() {
        refreshDashboard();
      });
      
      // 监听滚动事件，改变导航栏样式
      window.addEventListener('scroll', function() {
        const header = document.getElementById('header');
        if (window.scrollY > 10) {
          header.classList.add('shadow');
        } else {
          header.classList.remove('shadow');
        }
      });
      
      // 模拟WebSocket实时数据推送
      simulateWebSocketUpdates();
    });
    
    // 初始化所有图表
    function initCharts() {
      // 小型趋势图表 - 任务总数
      new Chart(document.getElementById('tasksChart'), {
        type: 'line',
        data: {
          labels: ['', '', '', '', '', '', '', '', '', ''],
          datasets: [{
            data: [650, 720, 680, 750, 820, 880, 950, 1050, 1180, 1284],
            borderColor: '#165DFF',
            backgroundColor: 'rgba(22, 93, 255, 0.1)',
            borderWidth: 2,
            pointRadius: 0,
            tension: 0.4,
            fill: true
          }]
        },
        options: getSmallChartOptions()
      });
      
      // 小型趋势图表 - 活跃节点数
      new Chart(document.getElementById('nodesChart'), {
        type: 'line',
        data: {
          labels: ['', '', '', '', '', '', '', '', '', ''],
          datasets: [{
            data: [22, 25, 24, 28, 30, 29, 31, 33, 35, 36],
            borderColor: '#36CFC9',
            backgroundColor: 'rgba(54, 207, 201, 0.1)',
            borderWidth: 2,
            pointRadius: 0,
            tension: 0.4,
            fill: true
          }]
        },
        options: getSmallChartOptions()
      });
      
      // 小型趋势图表 - 数据流量
      new Chart(document.getElementById('trafficChart'), {
        type: 'line',
        data: {
          labels: ['', '', '', '', '', '', '', '', '', ''],
          datasets: [{
            data: [950, 920, 900, 890, 880, 870, 860, 855, 850, 846],
            borderColor: '#1890FF',
            backgroundColor: 'rgba(24, 144, 255, 0.1)',
            borderWidth: 2,
            pointRadius: 0,
            tension: 0.4,
            fill: true
          }]
        },
        options: getSmallChartOptions()
      });
      
      // 小型趋势图表 - 平均延迟
      new Chart(document.getElementById('latencyChart'), {
        type: 'line',
        data: {
          labels: ['', '', '', '', '', '', '', '', '', ''],
          datasets: [{
            data: [320, 310, 300, 290, 280, 270, 260, 255, 250, 246],
            borderColor: '#FAAD14',
            backgroundColor: 'rgba(250, 173, 20, 0.1)',
            borderWidth: 2,
            pointRadius: 0,
            tension: 0.4,
            fill: true
          }]
        },
        options: getSmallChartOptions()
      });
      
      // 系统性能趋势图表
      new Chart(document.getElementById('systemTrendChart'), {
        type: 'line',
        data: {
          labels: ['00:00', '03:00', '06:00', '09:00', '12:00', '15:00', '18:00', '21:00', '现在'],
          datasets: [
            {
              label: '数据流量 (GB)',
              data: [45, 35, 30, 60, 95, 120, 110, 85, 70],
              borderColor: '#165DFF',
              backgroundColor: 'rgba(22, 93, 255, 0.05)',
              borderWidth: 2,
              tension: 0.4,
              fill: true,
              yAxisID: 'y'
            },
            {
              label: '平均延迟 (ms)',
              data: [280, 260, 240, 250, 270, 290, 280, 260, 246],
              borderColor: '#FAAD14',
              backgroundColor: 'transparent',
              borderWidth: 2,
              tension: 0.4,
              fill: false,
              yAxisID: 'y1'
            },
            {
              label: '活跃节点数',
              data: [20, 18, 15, 25, 30, 32, 34, 35, 36],
              borderColor: '#36CFC9',
              backgroundColor: 'transparent',
              borderWidth: 2,
              tension: 0.4,
              fill: false,
              yAxisID: 'y2'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false,
          },
          plugins: {
            legend: {
              position: 'top',
              labels: {
                boxWidth: 10,
                usePointStyle: true,
                pointStyle: 'circle'
              }
            },
            tooltip: {
              padding: 10,
              boxPadding: 5,
              usePointStyle: true
            }
          },
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              type: 'linear',
              display: true,
              position: 'left',
              title: {
                display: true,
                text: '数据流量 (GB)'
              },
              grid: {
                color: 'rgba(0, 0, 0, 0.05)'
              }
            },
            y1: {
              type: 'linear',
              display: true,
              position: 'right',
              title: {
                display: true,
                text: '平均延迟 (ms)'
              },
              grid: {
                drawOnChartArea: false
              }
            },
            y2: {
              type: 'linear',
              display: false
            }
          }
        }
      });
    }
    
    // 获取小型图表的配置选项
    function getSmallChartOptions() {
      return {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            enabled: false
          }
        },
        scales: {
          x: {
            display: false
          },
          y: {
            display: false
          }
        },
        elements: {
          line: {
            tension: 0.4
          }
        }
      };
    }
    
    // 刷新仪表盘数据
    function refreshDashboard() {
      // 添加旋转动画
      const refreshBtn = document.getElementById('refreshBtn').querySelector('i');
      refreshBtn.classList.add('fa-spin');
      
      // 模拟数据加载延迟
      setTimeout(() => {
        // 更新统计数字
        updateStats();
        
        // 更新最后更新时间
        document.getElementById('lastUpdate').textContent = '刚刚';
        
        // 移除旋转动画
        refreshBtn.classList.remove('fa-spin');
        
        // 显示更新成功提示
        showNotification('仪表盘已更新', 'success');
      }, 1000);
    }
    
    // 更新统计数据
    function updateStats() {
      // 任务总数随机增加5-15
      const totalTasks = parseInt(document.getElementById('totalTasks').textContent.replace(',', '')) + Math.floor(Math.random() * 11) + 5;
      document.getElementById('totalTasks').textContent = totalTasks.toLocaleString();
      
      // 活跃节点数随机±1
      const activeNodes = parseInt(document.getElementById('activeNodes').textContent) + (Math.random() > 0.7 ? 1 : (Math.random() > 0.5 ? -1 : 0));
      document.getElementById('activeNodes').textContent = Math.max(0, activeNodes);
      
      // 数据流量随机±5
      const dataTraffic = parseInt(document.getElementById('dataTraffic').textContent) + (Math.random() > 0.5 ? 5 : -5);
      document.getElementById('dataTraffic').textContent = Math.max(0, dataTraffic) + ' GB';
      
      // 平均延迟随机±10
      const avgLatency = parseInt(document.getElementById('avgLatency').textContent) + (Math.random() > 0.5 ? 10 : -10);
      document.getElementById('avgLatency').textContent = Math.max(10, avgLatency) + ' ms';
    }
    
    // 显示通知提示
    function showNotification(message, type = 'info') {
      // 创建通知元素
      const notification = document.createElement('div');
      notification.className = `fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg flex items-center z-50 transform translate-y-10 opacity-0 transition-all duration-300 ${
        type === 'success' ? 'bg-success text-white' : 
        type === 'error' ? 'bg-danger text-white' : 
        'bg-primary text-white'
      }`;
      
      // 设置图标
      const icon = type === 'success' ? 'check-circle' : 
                   type === 'error' ? 'exclamation-circle' : 'info-circle';
      
      notification.innerHTML = `
        <i class="fa fa-${icon} mr-2"></i>
        <span>${message}</span>
      `;
      
      // 添加到页面
      document.body.appendChild(notification);
      
      // 显示通知
      setTimeout(() => {
        notification.classList.remove('translate-y-10', 'opacity-0');
      }, 10);
      
      // 3秒后隐藏通知
      setTimeout(() => {
        notification.classList.add('translate-y-10', 'opacity-0');
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 3000);
    }
    
    // 模拟WebSocket实时数据更新
    function simulateWebSocketUpdates() {
      // 每30-60秒随机更新一次数据
      setInterval(() => {
        // 70%的概率更新数据
        if (Math.random() > 0.3) {
          updateStats();
          document.getElementById('lastUpdate').textContent = '刚刚';
          
          // 10%的概率添加新任务
          if (Math.random() > 0.9) {
            addNewTask();
          }
          
          // 15%的概率添加新告警
          if (Math.random() > 0.85) {
            addNewAlert();
          }
        }
      }, Math.floor(Math.random() * 30000) + 30000); // 30-60秒
    }
    
    // 添加新任务
    function addNewTask() {
      const taskTypes = ['数据备份', '安全审计', '系统更新', '性能测试', '日志清理'];
      const发起人 = ['张三', '李四', '王五', '赵六', '系统自动'];
      const randomType = taskTypes[Math.floor(Math.random() * taskTypes.length)];
      const randomUser =发起人[Math.floor(Math.random() * 发起人.length)];
      const progress = Math.floor(Math.random() * 60) + 10;
      
      const taskHTML = `
        <div class="border-b border-light-2 pb-4 animate-fadeIn">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-medium text-dark">${randomType}</h3>
            <span class="px-2 py-0.5 text-xs rounded-full bg-warning/10 text-warning">进行中</span>
          </div>
          <div class="flex justify-between text-sm text-dark-2 mb-2">
            <span>发起人: ${randomUser}</span>
            <span>刚刚</span>
          </div>
          <div class="text-xs text-dark-2 mb-1">任务类型: ${Math.random() > 0.5 ? '系统任务' : '安全任务'}</div>
          <div class="w-full bg-light-1 rounded-full h-1.5 progress-bar">
            <div class="bg-warning h-1.5 rounded-full" style="width: ${progress}%"></div>
          </div>
        </div>
      `;
      
      const tasksContainer = document.getElementById('recentTasks');
      const firstChild = tasksContainer.firstChild;
      tasksContainer.insertBefore(document.createRange().createContextualFragment(taskHTML), firstChild);
      
      // 移除最后一个任务
      const tasks = tasksContainer.children;
      if (tasks.length > 4) {
        tasksContainer.removeChild(tasks[tasks.length - 1]);
      }
      
      showNotification(`新增任务: ${randomType}`, 'info');
    }
    
    // 添加新告警
    function addNewAlert() {
      const alertTypes = [
        {type: 'TEE远程证明失败', icon: 'exclamation-triangle', color: 'danger', message: '节点node-' + Math.floor(Math.random() * 30) + '的TEE远程证明验证失败'},
        {type: '节点掉线', icon: 'sign-out', color: 'warning', message: '节点node-' + Math.floor(Math.random() * 30) + '失去连接超过15分钟'},
        {type: '攻击告警', icon: 'shield', color: 'danger', message: '检测到来自IP: 192.168.1.' + Math.floor(Math.random() * 255) + '的异常访问模式'}
      ];
      
      const randomAlert = alertTypes[Math.floor(Math.random() * alertTypes.length)];
      
      const alertHTML = `
        <tr class="hover:bg-light-1/50 transition-colors animate-fadeIn">
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="flex items-center">
              <div class="w-8 h-8 rounded-full bg-${randomAlert.color}/10 flex items-center justify-center mr-3">
                <i class="fa fa-${randomAlert.icon} text-${randomAlert.color}"></i>
              </div>
              <div>
                <div class="text-sm font-medium text-dark">${randomAlert.type}</div>
              </div>
            </div>
          </td>
          <td class="px-6 py-4">
            <div class="text-sm text-dark-2">${randomAlert.message}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-dark-2">刚刚</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="px-2 py-1 text-xs rounded-full bg-${randomAlert.color}/10 text-${randomAlert.color}">未处理</span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
            <button class="text-primary hover:text-primary/80 mr-3">处理</button>
            <button class="text-dark-2 hover:text-dark">忽略</button>
          </td>
        </tr>
      `;
      
      const tableBody = document.querySelector('tbody');
      const firstRow = tableBody.firstChild;
      tableBody.insertBefore(document.createRange().createContextualFragment(alertHTML), firstRow);
      
      // 更新告警数量
      const alertCountEl = document.querySelector('.text-danger.font-medium');
      alertCountEl.textContent = parseInt(alertCountEl.textContent) + 1;
      
      showNotification(`新告警: ${randomAlert.type}`, 'error');
    }
  </script>
</body>
</html>
